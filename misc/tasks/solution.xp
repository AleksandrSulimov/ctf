#!/usr/bin/expect

set timeout 10
spawn nc 62.173.140.174 10300

expect ">>>"
send "start\r"

set i 1
while {$i<=100} {
        expect {
          -re {\(\d+/100\) (\w+)} {
            set hash $expect_out(1,string)
          }
        }

        set command "hashcat -m 0 -a 0 $hash --potfile-disable /usr/share/wordlists/rockyou.txt | grep '$hash:' | cut -d ':' >
        set result [exec bash -c $command]

        send "$result\r"
        expect ">>>"
                incr i
}
interact